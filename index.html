<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>حاسبة دجاج التسمين الواقعية</title>

<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
</head>

<body class="bg-gray-100 min-h-screen text-gray-800">

<header class="bg-green-700 text-white py-6 text-center shadow">
  <h1 class="text-3xl font-extrabold">
    <i class="fa-solid fa-drumstick-bite ml-2"></i>
    حاسبة دجاج التسمين
  </h1>
  <p class="mt-2 font-semibold">حساب فلاحي واقعي (بدون أرقام وهمية)</p>
</header>

<div id="app" class="max-w-4xl mx-auto p-4 py-10">

<div class="bg-white rounded-xl shadow-xl overflow-hidden">

<!-- Inputs -->
<div class="grid md:grid-cols-2 gap-4 p-6 bg-gray-50">
  <div v-for="(label,key) in labels" :key="key">
    <label class="block font-bold text-sm mb-1">{{ label }}</label>
    <input type="number" v-model.number="form[key]"
      class="w-full border rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 outline-none">
  </div>
</div>

<!-- Button -->
<div class="p-6 border-t">
  <button @click="calculate"
    class="w-full bg-green-600 text-white py-3 rounded-lg font-bold">
    <i class="fa-solid fa-calculator ml-1"></i> احسب
  </button>
</div>

<!-- Error -->
<div v-if="error" class="p-4 text-center text-red-600 font-bold">
  {{ error }}
</div>

<!-- Results -->
<div v-if="result" class="p-6 border-t space-y-4">

  <!-- Final Result -->
  <div :class="result.profit>=0 ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'"
    class="rounded-xl p-6 text-center font-extrabold">
    <div class="text-xl mb-2">
      {{ result.profit>=0 ? 'الربح الحقيقي' : 'الخسارة الحقيقية' }}
    </div>
    <div class="text-4xl">
      {{ readMoney(result.profit) }}
    </div>
  </div>

  <!-- Details -->
  <div class="grid md:grid-cols-2 gap-4 text-center">

    <div class="border rounded-lg p-4">
      <p class="text-sm text-gray-500">إجمالي الإيرادات</p>
      <p class="text-xl font-bold text-green-700">
        {{ readMoney(result.income) }}
      </p>
    </div>

    <div class="border rounded-lg p-4">
      <p class="text-sm text-gray-500">إجمالي التكاليف</p>
      <p class="text-xl font-bold text-red-600">
        {{ readMoney(result.totalCosts) }}
      </p>
    </div>

    <div class="border rounded-lg p-4">
      <p class="text-sm text-gray-500">خسارة النافق + غير المباع</p>
      <p class="text-xl font-bold text-orange-600">
        {{ readMoney(result.lossDead) }}
      </p>
    </div>

    <div class="border rounded-lg p-4">
      <p class="text-sm text-gray-500">نسبة النفوق</p>
      <p class="text-xl font-bold">
        {{ result.mortality }}%
      </p>
    </div>

  </div>

</div>
</div>

<footer class="text-center text-sm text-gray-500 mt-10">
  تطوير: <b class="text-green-700">Kaci Mebarek</b>
</footer>

</div>

<script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
<script>
const { createApp, ref } = Vue;

createApp({
setup(){

const form = ref({
  priceChick:0,
  numChicks:0,
  feedPrice:0,
  feedUsed:0,
  sellPrice:0,
  commission:0,
  medicine:0,
  energy:0,
  bedding:0,
  cleaning:0,
  dead:0,
  unsold:0,
  totalWeight:0
});

const labels = {
  priceChick:'سعر الكتكوت',
  numChicks:'عدد الكتاكيت',
  feedPrice:'سعر القنطار علف',
  feedUsed:'كمية العلف (قنطار)',
  sellPrice:'سعر بيع الكيلو',
  commission:'عمولة الكيلو',
  medicine:'الدواء',
  energy:'ماء + كهرباء',
  bedding:'الفرشة',
  cleaning:'التنظيف',
  dead:'النافق',
  unsold:'غير المباع',
  totalWeight:'الوزن المباع (كغ)'
};

const result = ref(null);
const error = ref(null);

function calculate(){
  error.value = null;

  if(form.value.numChicks<=0 || form.value.totalWeight<=0 || form.value.sellPrice<=0){
    error.value = 'تحقق من عدد الكتاكيت، الوزن، وسعر البيع';
    return;
  }

  const total = form.value.numChicks;
  const dead = form.value.dead;
  const unsold = form.value.unsold;
  const sold = total - dead - unsold;

  if(sold<=0){
    error.value = 'لا يوجد دجاج مباع';
    return;
  }

  const income = form.value.totalWeight * form.value.sellPrice;

  const totalCosts =
    (form.value.priceChick * total) +
    (form.value.feedPrice * form.value.feedUsed) +
    (form.value.commission * form.value.totalWeight) +
    form.value.medicine +
    form.value.energy +
    form.value.bedding +
    form.value.cleaning;

  // خسارة صريحة للنافق + غير المباع
  const deadCount = dead + unsold;
  const chickLoss = deadCount * form.value.priceChick;

  const feedShare = form.value.feedUsed * (deadCount / total);
  const feedLoss = feedShare * form.value.feedPrice;

  const lossDead = chickLoss + feedLoss;

  const profit = income - totalCosts - lossDead;

  result.value = {
    income,
    totalCosts,
    lossDead,
    profit,
    mortality: ((deadCount/total)*100).toFixed(2)
  };
}

function readMoney(v){
  const n = Math.abs(Math.round(v));
  if(n>=100000) return (Math.round(n/10000))+' مليون';
  if(n>=10000) return 'مليون';
  if(n>=1000) return '100 ألف';
  if(n>=100) return '10 آلاف';
  return n+' دج';
}

return { form, labels, calculate, result, error, readMoney };
}
}).mount('#app');
</script>

</body>
</html>
